package main.java;
import buildGUI.CustomOutputStream;
import java.util.logging.*;

import javax.swing.SwingUtilities;

import java.io.PrintStream;
import java.net.URL;
import java.sql.Driver;
import java.util.*;

import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeDriverService;
import org.openqa.selenium.htmlunit.HtmlUnitDriver;
import org.openqa.selenium.support.pagefactory.ByChained;

import com.google.j2objc.annotations.ReflectionSupport.Level;

import org.apache.commons.logging.LogFactory;
import org.openqa.selenium.*;
import buildGUI.buildGUI;

public class scanForForms extends buildGUI{
	
	public static void main(String[] args) {
		SwingUtilities.invokeLater(new Runnable()
		{
		public void run() {
		
		System.setProperty("webdriver.chrome.driver", "C:\\Selenium Environment\\chromeDriverNew\\chromeDriver.exe");
		System.setProperty(ChromeDriverService.CHROME_DRIVER_SILENT_OUTPUT_PROPERTY,"true");
	//	java.util.logging.Logger.getLogger("com.gargoylesoftware").setLevel(Level.OFF);
		

		LogFactory.getFactory().setAttribute("org.apache.commons.logging.Log", "org.apache.commons.logging.impl.NoOpLog");
		WebDriver driver = new HtmlUnitDriver();
		
	
		System.out.append("");
		//String URL = txtEnterUrl.getText();
		driver.get("http://localhost/dvwa/vulnerabilities/sqli/");
		driver.findElement(By.className("loginInput")).sendKeys("admin");
		driver.findElement(By.name("password")).sendKeys("password");
		driver.findElement(By.name("Login")).click();
		
		try {
	        Thread.sleep(10*100);
	    } catch (InterruptedException e) {
	        e.printStackTrace();
	    }
		driver.get("http://localhost/dvwa/vulnerabilities/sqli/");
		
	    List<WebElement> inputForm = driver.findElements(By.xpath("//input[@type='text']"));
		List<WebElement> usernameForm = driver.findElements(By.name("username"));
		List<WebElement> passwordForm = driver.findElements(By.name("password"));
		List<WebElement> searchForm = driver.findElements(By.className("search"));
		 try {
		        Thread.sleep(10*100);
		    } catch (InterruptedException e) {
		        e.printStackTrace();
		    }
		System.out.append(".............Loading............\n");
		System.out.append("\n");
		 try {
		        Thread.sleep(10*100);
		    } catch (InterruptedException e) {
		        e.printStackTrace();
		    }
		if(usernameForm.isEmpty()){
			System.out.append("No username form found ....\n");
			System.out.append("");
		} 
		
		 if (passwordForm.isEmpty()) {
			System.out.append("No password form found .... \n");
			
			 try {
			        Thread.sleep(10*100);
			    } catch (InterruptedException e) {
			        e.printStackTrace();
			    }
		} 
		if (searchForm.isEmpty()) {
			System.out.append("No search form found\n");
			System.out.append("\n");
			 try {
			        Thread.sleep(10*100);
			    } catch (InterruptedException e) {
			        e.printStackTrace();
			    }
		} else if (inputForm.isEmpty()) {
			System.out.append("No input form found\n");
			System.out.append("\n");
			 try {
			        Thread.sleep(10*100);
			    } catch (InterruptedException e) {
			        e.printStackTrace();
			    }
		}
		for(int i =0; i < usernameForm.size(); i++){
		     System.out.append("Username form" +usernameForm.get(i) + " Found on Page\n");
		     try {
		         Thread.sleep(10*100);
		     } catch (InterruptedException e) {
		         e.printStackTrace();
		     }
		  }
		for(int i =0; i < passwordForm.size(); i++){
			System.out.append("          ...... Success ......\n");
			System.out.append("\n");
		     System.out.append("Password form" +passwordForm.get(i) + " Found on Page\n");
		     try {
		         Thread.sleep(10*100);
		     } catch (InterruptedException e) {
		         e.printStackTrace();
		     }
		  }
		for(int i =0; i < searchForm.size(); i++){
			System.out.append("             ...... Success ......\n");
		     System.out.append("Search form" +searchForm.get(i) + " Found on Page\n");
		     try {
		         Thread.sleep(10*100);
		     } catch (InterruptedException e) {
		         e.printStackTrace();
		     }
		  }
		
		for(int i =0; i < inputForm.size(); i++){
			System.out.append("             ...... Success ......\n");
		     System.out.append("Input form :" +inputForm.get(i) + " Found on Page\n");
		     try {
		         Thread.sleep(10*100);
		     } catch (InterruptedException e) {
		         e.printStackTrace();
		    }
		  }
		}
 	  });
	}
}	

